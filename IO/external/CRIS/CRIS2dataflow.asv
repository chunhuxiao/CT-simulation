function dataflow = CRIS2dataflow(pdfile, CRISpath)
% read .pd rawdata
% dataflow = CRIS2dataflow(pdfile, CRISpath);
% INPUT:
%   pdfile          filename for a cell of filenames
%   CRISpath        external IO platform

if isempty(CRISpath)
    % default CRIS path
    CRISpath = 'E:\matlab\CRIS';
    % I know it is
end

% read data
currpath = pwd;
cd(CRISpath);
raw = readRaw(pdfile, 1);
cd(currpath);

% to dataflow
dataflow = struct();
% rawdata
dataflow.rawdata = reraw.active.chanData;
% rawdata head
dataflow.rawhead = struct();
dataflow.rawhead.mA = raw.active.header.mA;
dataflow.rawhead.KV = raw.active.header.kv;
N0 = 69120;
viewcodes = (0:raw.header.numView-1).*(N0/raw.head.trigFrequency*raw.head.gantrySpeed);
startcode = round(raw.head.startAngle*N0/360);
viewcodes = mod(viewcodes + startcode, N0);
dataflow.rawhead.Angle_encoder = viewcodes;
dataflow.rawhead.Reading_Number = raw.active.header.AdcViewNum;
dataflow.rawhead.Integration_Time = 


% offset
dataflow.offset = raw.offset.chanData;
% offset head
dataflow.offhead = struct();
% skip

end