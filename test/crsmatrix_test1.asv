% function C = crsmatrix_test1(p)

P = P(:);
N = size(P,1);

P = diag(P);
D = diag(ones(N,1)) -diag(ones(N-1,1),1);

A = eye(N)+D*P*D';
Ad = diag(diag(A));
Ap = A-Ad;

C = (eye(N)-Ap)*inv(Ad) - eye(N);
